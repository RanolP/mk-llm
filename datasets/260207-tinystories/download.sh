#!/usr/bin/env bash
# TinyStories dataset
# https://huggingface.co/datasets/roneneldan/TinyStories
#
# Small synthetic dataset (~2GB) designed for training small LMs
# Contains simple short stories generated by GPT-3.5/4

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

if ../check.sh; then exit 0; fi

echo "Downloading TinyStories dataset..."

# Download from HuggingFace
uvx --from huggingface-hub hf download roneneldan/TinyStories \
    --repo-type dataset \
    --local-dir raw \
    --include "*.txt"

# Combine into single training file
echo "Combining files..."
cat raw/TinyStoriesV2-GPT4-train.txt > train.txt
cat raw/TinyStoriesV2-GPT4-valid.txt > valid.txt

echo "Done!"
echo "  train.txt: $(wc -l < train.txt) lines"
echo "  valid.txt: $(wc -l < valid.txt) lines"

sha256sum train.txt valid.txt > checksums.sha256
